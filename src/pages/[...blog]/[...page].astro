---
import Layout from '~/layouts/PageLayout.astro';
import BlogList from '~/components/blog/List.astro';
import Headline from '~/components/blog/Headline.astro';
import Pagination from '~/components/blog/Pagination.astro';
import PostTags from '~/components/blog/Tags.astro';

import { blogListRobots, getStaticPathsBlogList, fetchPosts } from '~/utils/blog';

export const getStaticPaths = async ({ paginate }) => {
  return await getStaticPathsBlogList({ paginate });
};

const { page } = Astro.props;
const metadata = {
  title: `Magazin â€” HomeIQ`,
  robots: blogListRobots,
};

const allPosts = await fetchPosts();
const allCategories = [...new Set(allPosts.map((post) => post.category).filter(Boolean))];
---

<Layout metadata={metadata}>
  <section class="relative py-12 md:py-20 overflow-hidden bg-gradient-to-b from-blue-50 to-white dark:from-slate-900 dark:to-slate-950">
    <div class="relative max-w-7xl mx-auto px-4 sm:px-6">
      <div class="text-center max-w-3xl mx-auto">
        <Headline
          tagline="HomeIQ Magazin"
          class="text-5xl md:text-6xl font-extrabold tracking-tighter mb-4 font-heading"
        >
          Smart Home Wissen & Trends
        </Headline>
        <p class="text-xl text-muted dark:text-slate-400">
          Entdecke, wie du dein Zuhause in Luxemburg intelligenter, sicherer und energieeffizienter machst.
        </p>
      </div>
    </div>
  </section>

  <section class="px-4 py-16 mx-auto max-w-7xl">
    
    <div class="flex flex-wrap justify-center mb-12 gap-3">
      <a href="/blog" class="px-4 py-2 rounded-full bg-primary text-white font-medium shadow-md">Alle</a>
      {allCategories.map((cat) => (
        <span class="px-4 py-2 rounded-full bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 hover:border-primary transition-colors cursor-pointer text-muted dark:text-slate-300">
          {cat}
        </span>
      ))}
    </div>

    <div class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
      <BlogList posts={page.data} />
    </div>

    <div class="mt-16 border-t border-gray-100 dark:border-slate-800 pt-10">
      <Pagination prevUrl={page.url.prev} nextUrl={page.url.next} />
    </div>
  </section>

  <div class="max-w-7xl mx-auto px-4 py-20">
    <div class="relative rounded-3xl overflow-hidden bg-blue-600 dark:bg-blue-700 shadow-2xl">
      <div class="absolute top-0 right-0 -mt-10 -mr-10 w-64 h-64 bg-blue-500 rounded-full opacity-20"></div>
      <div class="relative flex flex-col md:flex-row items-center justify-between p-10 md:p-16 gap-8">
        <div class="text-white text-center md:text-left">
          <h2 class="text-3xl md:text-4xl font-bold mb-4">Individuelle Beratung?</h2>
          <p class="text-blue-100 text-lg max-w-md">Lass uns gemeinsam dein Smart Home Projekt planen. Kostenlos und unverbindlich.</p>
        </div>
        <a href="/kontakt" class="bg-white text-blue-600 hover:bg-gray-100 px-8 py-4 rounded-xl font-bold text-lg transition-all transform hover:scale-105 shadow-lg">
          Jetzt Termin buchen
        </a>
      </div>
    </div>
  </div>
</Layout>